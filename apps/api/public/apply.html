<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Join Our Team – VERGO Events</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
      background: #0a0a0a;
      color: #e0e0e0;
      line-height: 1.6;
    }
    
    /* Header Navigation */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(212, 175, 55, 0.2);
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
    }
    
    .logo {
      font-size: 1.8rem;
      font-weight: 700;
      color: #D4AF37;
      letter-spacing: 2px;
      text-decoration: none;
    }
    
    nav ul {
      display: flex;
      gap: 35px;
      list-style: none;
    }
    
    nav a {
      color: #ffffff;
      text-decoration: none;
      font-size: 0.95rem;
      font-weight: 500;
      transition: color 0.3s ease;
      position: relative;
    }
    
    nav a::after {
      content: '';
      position: absolute;
      bottom: -5px;
      left: 0;
      width: 0;
      height: 2px;
      background: #D4AF37;
      transition: width 0.3s ease;
    }
    
    nav a:hover {
      color: #D4AF37;
    }
    
    nav a:hover::after {
      width: 100%;
    }
    
    .menu-toggle {
      display: none;
      flex-direction: column;
      gap: 5px;
      cursor: pointer;
    }
    
    .menu-toggle span {
      width: 25px;
      height: 2px;
      background: #D4AF37;
    }
    
    /* Hero */
    .hero {
      background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2c 100%);
      padding: 180px 40px 80px;
      text-align: center;
      border-bottom: 2px solid #D4AF37;
    }
    
    .hero h1 {
      font-size: 3.5rem;
      margin-bottom: 20px;
      color: #D4AF37;
      font-weight: 700;
    }
    
    .hero p {
      font-size: 1.3rem;
      color: #bbb;
      max-width: 700px;
      margin: 0 auto 40px;
    }
    
    .hero-cta {
      display: inline-block;
      padding: 18px 50px;
      background: #D4AF37;
      color: #1a1a1a;
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      border-radius: 4px;
      transition: all 0.3s ease;
      text-transform: uppercase;
      letter-spacing: 1.5px;
    }
    
    .hero-cta:hover {
      background: #fff;
      transform: scale(1.05);
    }
    
    /* Container */
    .container {
      max-width: 800px;
      margin: 0 auto;
      padding: 80px 20px;
    }
    
    .form-card {
      background: #1a1a1a;
      padding: 50px 40px;
      border-radius: 12px;
      border: 2px solid #2a2a2a;
    }
    
    h2 {
      color: #D4AF37;
      margin-bottom: 15px;
      font-size: 2rem;
    }
    
    .form-intro {
      color: #bbb;
      margin-bottom: 40px;
      font-size: 1.1rem;
      line-height: 1.8;
    }
    
    label {
      display: block;
      margin: 30px 0 10px;
      font-weight: 600;
      color: #D4AF37;
      font-size: 1rem;
    }
    
    input[type="text"],
    input[type="email"],
    input[type="tel"],
    input[type="file"] {
      width: 100%;
      padding: 15px;
      border: 2px solid #2a2a2a;
      border-radius: 6px;
      font-size: 1rem;
      transition: all 0.3s;
      font-family: inherit;
      background: #0a0a0a;
      color: #e0e0e0;
    }
    
    input[type="text"]:focus,
    input[type="email"]:focus,
    input[type="tel"]:focus,
    input[type="file"]:focus {
      outline: none;
      border-color: #D4AF37;
      background: #1a1a1a;
    }
    
    /* Roles Section */
    .roles-section {
      margin: 30px 0;
    }
    
    .roles-category {
      margin-bottom: 25px;
    }
    
    .category-title {
      font-weight: 600;
      color: #D4AF37;
      font-size: 0.95rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #2a2a2a;
    }
    
    .roles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }
    
    .role-checkbox {
      display: flex;
      align-items: center;
      padding: 12px 15px;
      background: #0a0a0a;
      border: 2px solid #2a2a2a;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s;
      user-select: none;
    }
    
    .role-checkbox:hover {
      background: #1a1a1a;
      border-color: #D4AF37;
    }
    
    .role-checkbox input[type="checkbox"] {
      width: 18px;
      height: 18px;
      margin-right: 10px;
      cursor: pointer;
      accent-color: #D4AF37;
    }
    
    .role-checkbox input[type="checkbox"]:checked ~ label {
      font-weight: 600;
      color: #D4AF37;
    }
    
    .role-checkbox label {
      margin: 0;
      font-weight: 400;
      font-size: 0.95rem;
      cursor: pointer;
      flex: 1;
      color: #bbb;
    }
    
    /* File Input */
    input[type="file"]::file-selector-button {
      padding: 12px 25px;
      background: #D4AF37;
      color: #1a1a1a;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      margin-right: 15px;
      transition: background 0.3s;
    }
    
    input[type="file"]::file-selector-button:hover {
      background: #fff;
    }
    
    /* Consent */
    .consent {
      display: flex;
      gap: 12px;
      align-items: flex-start;
      margin-top: 25px;
      font-size: 0.95rem;
      color: #bbb;
    }
    
    .consent input[type="checkbox"] {
      margin-top: 2px;
      accent-color: #D4AF37;
      width: 18px;
      height: 18px;
    }
    
    .consent a {
      color: #D4AF37;
      text-decoration: underline;
    }
    
    .consent a:hover {
      color: #fff;
    }

    button[type="submit"] {
      width: 100%;
      padding: 18px;
      background: #D4AF37;
      color: #1a1a1a;
      border: none;
      border-radius: 6px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 35px;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    button[type="submit"]:hover:not(:disabled) {
      background: #fff;
      transform: translateY(-2px);
    }
    
    button[type="submit"]:disabled {
      background: #666;
      cursor: not-allowed;
      transform: none;
    }
    
    .info-box {
      background: rgba(212, 175, 55, 0.1);
      border-left: 4px solid #D4AF37;
      padding: 20px;
      margin: 30px 0;
      border-radius: 6px;
      font-size: 0.95rem;
      color: #bbb;
    }
    
    .info-box strong {
      display: block;
      margin-bottom: 8px;
      color: #D4AF37;
      font-size: 1rem;
    }
    
    /* Footer */
    footer {
      background: #0a0a0a;
      color: #D4AF37;
      padding: 50px 40px 30px;
      border-top: 2px solid #1a1a1a;
      margin-top: 80px;
    }
    
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 40px;
      margin-bottom: 30px;
    }
    
    .footer-section h3 {
      font-size: 1.3rem;
      margin-bottom: 20px;
      color: #D4AF37;
    }
    
    .footer-section ul {
      list-style: none;
    }
    
    .footer-section ul li {
      margin-bottom: 10px;
    }
    
    .footer-section a {
      color: #999;
      text-decoration: none;
      transition: color 0.3s ease;
    }
    
    .footer-section a:hover {
      color: #D4AF37;
    }
    
    .footer-bottom {
      text-align: center;
      padding-top: 20px;
      border-top: 1px solid #333;
      color: #666;
    }
    
    @media (max-width: 1024px) {
      nav ul {
        position: fixed;
        top: 80px;
        left: 0;
        right: 0;
        background: rgba(10, 10, 10, 0.98);
        flex-direction: column;
        padding: 30px;
        gap: 20px;
        transform: translateX(-100%);
        transition: transform 0.3s ease;
      }
      
      nav ul.active {
        transform: translateX(0);
      }
      
      .menu-toggle {
        display: flex;
      }
    }
    
    @media (max-width: 768px) {
      header {
        padding: 15px 20px;
      }
      
      .logo {
        font-size: 1.5rem;
      }
      
      .hero {
        padding: 120px 20px 40px;
      }
      
      .hero h1 {
        font-size: 2.2rem;
      }
      
      .container {
        padding: 50px 15px;
      }
      
      .form-card {
        padding: 30px 20px;
      }
      
      .roles-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- Header Navigation -->
  <header>
    <a href="index.html" class="logo">VERGO</a>
    
    <div class="menu-toggle" onclick="toggleMenu()">
      <span></span>
      <span></span>
      <span></span>
    </div>
    
    <nav>
      <ul id="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="hire-us.html">Event Management</a></li>
        <li><a href="hire-staff.html">Hire Staff</a></li>
        <li><a href="apply.html">Apply</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </header>
  
  <!-- Hero -->
  <div class="hero">
    <h1>Join Our Team</h1>
    <p>Build your career with London's leading event professionals</p>
    <a href="#application-form" class="hero-cta">Apply Now</a>
  </div>
  
  <!-- Application Form -->
  <div class="container">
    <div class="form-card" id="application-form">
      <h2>Application Form</h2>
      <p class="form-intro">
        We're always looking for talented individuals to join our roster. Fill out the form below and we'll be in touch within 2 weeks.
      </p>
      
      <form id="f">
        <label for="firstName">First Name *</label>
        <input 
          type="text"
          id="firstName"
          name="firstName" 
          required 
          minlength="2"
          maxlength="100"
          placeholder="John"
        />
        
        <label for="lastName">Last Name *</label>
        <input 
          type="text"
          id="lastName"
          name="lastName" 
          required 
          minlength="2"
          maxlength="100"
          placeholder="Smith"
        />
        
        <label for="email">Email Address *</label>
        <input 
          type="email"
          id="email"
          name="email" 
          required 
          maxlength="255"
          placeholder="john.smith@example.com"
        />
        
        <label for="phone">Phone Number</label>
        <input 
          type="tel"
          id="phone"
          name="phone" 
          maxlength="20"
          placeholder="07123 456789 (optional)"
        />
        
        <div class="roles-section">
          <label>What roles are you applying for? *</label>
          
          <div class="roles-category">
            <div class="category-title">🍽️ Hospitality</div>
            <div class="roles-grid">
              <div class="role-checkbox">
                <input type="checkbox" id="role-barista" name="roles" value="Barista" />
                <label for="role-barista">Barista</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-bartender" name="roles" value="Bartender" />
                <label for="role-bartender">Bartender</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-mixologist" name="roles" value="Mixologist" />
                <label for="role-mixologist">Mixologist</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-waiting" name="roles" value="Waiting Staff" />
                <label for="role-waiting">Waiting Staff</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-foh" name="roles" value="Front of House (FOH)" />
                <label for="role-foh">FOH</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-host" name="roles" value="Host/Hostess" />
                <label for="role-host">Host/Hostess</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-chef" name="roles" value="Chef" />
                <label for="role-chef">Chef</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-sous" name="roles" value="Sous Chef" />
                <label for="role-sous">Sous Chef</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-cdp" name="roles" value="Chef de Partie" />
                <label for="role-cdp">Chef de Partie</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-kp" name="roles" value="Kitchen Porter (KP)" />
                <label for="role-kp">Kitchen Porter</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-runner" name="roles" value="Runner" />
                <label for="role-runner">Runner</label>
              </div>
            </div>
          </div>
          
          <div class="roles-category">
            <div class="category-title">🎪 Events & Production</div>
            <div class="roles-grid">
              <div class="role-checkbox">
                <input type="checkbox" id="role-event-mgr" name="roles" value="Event Manager" />
                <label for="role-event-mgr">Event Manager</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-supervisor" name="roles" value="Event Supervisor" />
                <label for="role-supervisor">Event Supervisor</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-stagehand" name="roles" value="Stagehand" />
                <label for="role-stagehand">Stagehand</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-site-crew" name="roles" value="Site Crew" />
                <label for="role-site-crew">Site Crew</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-rigger" name="roles" value="Rigger" />
                <label for="role-rigger">Rigger</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-loader" name="roles" value="Loader" />
                <label for="role-loader">Loader</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-av" name="roles" value="AV Technician" />
                <label for="role-av">AV Technician</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-lighting" name="roles" value="Lighting Tech" />
                <label for="role-lighting">Lighting Tech</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-sound" name="roles" value="Sound Tech" />
                <label for="role-sound">Sound Tech</label>
              </div>
            </div>
          </div>
          
          <div class="roles-category">
            <div class="category-title">🏢 Venue & Operations</div>
            <div class="roles-grid">
              <div class="role-checkbox">
                <input type="checkbox" id="role-steward" name="roles" value="Steward" />
                <label for="role-steward">Steward</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-security" name="roles" value="Security (SIA)" />
                <label for="role-security">Security (SIA)</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-cleaner" name="roles" value="Cleaner" />
                <label for="role-cleaner">Cleaner</label>
              </div>
              <div class="role-checkbox">
                <input type="checkbox" id="role-driver" name="roles" value="Driver" />
                <label for="role-driver">Driver</label>
              </div>
            </div>
          </div>
        </div>
        
        <label for="cv">Your CV (PDF or Word) *</label>
        <input 
          type="file" 
          id="cv" 
          accept=".pdf,.doc,.docx" 
          required 
        />
        
        <div class="info-box">
          <strong>📋 What happens next?</strong>
          We review all applications within 48 hours. Maximum file size: 10MB.
        </div>
        
        <label class="consent">
          <input type="checkbox" id="consent" required />
          <span>
            I agree to VERGO processing my personal data for the purpose of handling my
            application, in line with the
            <a href="/privacy.html" target="_blank" rel="noopener">Privacy Policy</a>.
          </span>
        </label>
        
        <button type="submit">Submit Application</button>
      </form>
    </div>
  </div>
  
  <!-- Footer -->
  <footer>
    <div class="footer-content">
      <div class="footer-section">
        <h3>VERGO Events</h3>
        <p style="color: #666; line-height: 1.8;">Professional event management and staffing solutions across London.</p>
      </div>
      
      <div class="footer-section">
        <h3>Services</h3>
        <ul>
          <li><a href="hire-us.html">Event Management</a></li>
          <li><a href="hire-staff.html">Staff Hire</a></li>
          <li><a href="apply.html">Careers</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Company</h3>
        <ul>
          <li><a href="about.html">About Us</a></li>
          <li><a href="contact.html">Contact</a></li>
          <li><a href="privacy.html">Privacy Policy</a></li>
          <li><a href="terms.html">Terms & Conditions</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h3>Get in Touch</h3>
        <ul>
          <li><a href="mailto:wrobb@vergoltd.com">wrobb@vergoltd.com</a></li>
          <li style="color: #666;">London, United Kingdom</li>
        </ul>
      </div>
    </div>
    
    <div class="footer-bottom">
      <p>&copy; 2025 VERGO Events Ltd. All rights reserved.</p>
    </div>
  </footer>
  
  <<script>
(function () {
  const form = document.getElementById('f');
  if (!form) return;

  async function presign(file) {
    const body = { fileName: file.name, fileType: file.type || 'application/octet-stream' };
    const res = await fetch('/api/v1/applications/presign', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(body)
    });
    if (!res.ok) throw new Error('Failed to presign CV upload');
    return res.json(); // { url, key, fields? (if using POST), or putUrl if using PUT }
  }

  async function uploadToS3(putUrl, file) {
    // Your backend appears to use AWS SDK v3 patterns; router exposes /presign for a direct PUT
    const up = await fetch(putUrl, {
      method: 'PUT',
      headers: { 'Content-Type': file.type || 'application/octet-stream' },
      body: file
    });
    if (!up.ok) throw new Error('S3 upload failed');
  }

  async function verifyUpload(key) {
    const res = await fetch('/api/v1/applications/verify-upload', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ key })
    });
    if (!res.ok) throw new Error('Failed to verify upload');
    return res.json(); // { status: 'ok' }
  }

  function getRoles() {
    return Array.from(document.querySelectorAll('input[name="roles"]:checked')).map(x => x.value);
  }

  function bool(name) {
    const el = form.querySelector(`[name="${name}"]`);
    if (!el) return undefined;
    if (el.type === 'checkbox') return el.checked;
    return undefined;
  }

  function val(name) {
    const el = form.querySelector(`[name="${name}"]`);
    return el ? el.value.trim() : '';
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const btn = form.querySelector('[type="submit"]');
    if (btn) btn.disabled = true;

    try {
      // 0) Grab CV file
      const fileInput = form.querySelector('input[type="file"][name="cv"]');
      const file = fileInput && fileInput.files && fileInput.files[0];
      if (!file) throw new Error('Please attach your CV');

      // 1) Presign
      const { putUrl, key } = await presign(file);

      // 2) Upload
      await uploadToS3(putUrl, file);

      // 3) Verify
      await verifyUpload(key);

      // 4) Submit application
      const payload = {
        firstName: val('firstName'),
        lastName: val('lastName'),
        email: val('email'),
        phone: val('phone') || undefined,
        rightToWorkUk: bool('rightToWorkUk'),
        roles: getRoles(), // array<string>, required
        cvKey: key,        // required by API
        cvOriginalName: file.name,
        source: val('source') || undefined
      };

      const res = await fetch('/api/v1/applications', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });

      if (!res.ok) {
        const err = await res.json().catch(() => ({}));
        throw new Error(err?.error || 'Application submission failed');
      }

      alert('Thanks! Your application has been received.');
      form.reset();
    } catch (err) {
      console.error(err);
      alert(err.message || 'Something went wrong submitting your application');
    } finally {
      if (btn) btn.disabled = false;
    }
  });
})();
</script>

</body>
</html>