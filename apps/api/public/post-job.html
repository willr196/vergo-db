<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="/logo-small.png">
  <title>Post a Job | VERGO Ltd | London's Event Staffing Board</title>
  <meta name="description" content="Post your hospitality job on VERGO's job board. Reach London's best event staff - bartenders, chefs, waiters, and more. Free to post.">
  
  <!-- Security Headers -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
  
  <!-- Accessibility -->
  <link rel="stylesheet" href="/vergo-a11y.css">
  <link rel="stylesheet" href="/vergo-styles.css">
  <link rel="stylesheet" href="/vergo-mobile.css">
  
  <style>
    /* ============================================
     * STANDARD HEADER & NAV STYLES
     * ============================================ */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      background: rgba(10, 10, 10, 0.98);
      backdrop-filter: blur(10px);
      border-bottom: 1px solid rgba(212, 175, 55, 0.2);
      padding: 15px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
    }
    
    .logo {
      display: flex;
      align-items: center;
      text-decoration: none;
    }
    
    .logo img {
      height: 45px;
      width: auto;
      transition: transform 0.3s ease;
      border: none !important;
      background: transparent !important;
      display: block;
    }
    
    .logo:hover img {
      transform: scale(1.05);
    }
    
    nav ul {
      display: flex;
      gap: 30px;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    
    nav li {
      position: relative;
    }
    
    nav a {
      color: var(--color-text-primary);
      text-decoration: none;
      font-size: 0.9rem;
      font-weight: 500;
      transition: color 0.3s ease;
      position: relative;
      display: block;
      padding: 8px 0;
    }
    
    nav a::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 0;
      height: 2px;
      background: var(--color-gold);
      transition: width 0.3s ease;
    }
    
    nav a:hover {
      color: var(--color-gold);
    }
    
    nav a:hover::after {
      width: 100%;
    }
    
    nav a[aria-current="page"] {
      color: var(--color-gold);
    }
    
    nav a[aria-current="page"]::after {
      width: 100%;
    }
    
    /* Dropdown */
    .nav-dropdown {
      position: relative;
    }
    
    .dropdown-menu {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%) translateY(10px);
      background: var(--color-bg-white);
      border: 1px solid rgba(212, 175, 55, 0.2);
      border-radius: 8px;
      min-width: 180px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      padding: 8px 0;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
    }
    
    .nav-dropdown:hover .dropdown-menu,
    .nav-dropdown.active .dropdown-menu {
      opacity: 1;
      visibility: visible;
      transform: translateX(-50%) translateY(0);
    }
    
    .dropdown-menu a {
      padding: 10px 20px;
      display: block;
    }
    
    .dropdown-menu a::after {
      display: none;
    }
    
    .dropdown-menu a:hover {
      background: rgba(212, 175, 55, 0.1);
    }

    /* ============================================
     * PAGE CONTENT
     * ============================================ */
    .page-container {
      padding: 120px 40px 80px;
      min-height: 100vh;
      background: var(--color-bg-primary);
    }
    
    .page-header {
      max-width: 700px;
      margin: 0 auto 40px;
      text-align: center;
    }
    
    .page-header h1 {
      font-size: 2.2rem;
      color: var(--color-text-primary);
      margin-bottom: 12px;
    }
    
    .page-header p {
      color: var(--color-text-muted);
      font-size: 1.1rem;
    }

    /* Form Card */
    .form-card {
      max-width: 700px;
      margin: 0 auto;
      background: var(--color-bg-white);
      border-radius: 12px;
      padding: 40px;
      border: 1px solid var(--color-border);
    }
    
    .form-section {
      margin-bottom: 32px;
    }
    
    .form-section:last-child {
      margin-bottom: 0;
    }
    
    .form-section h2 {
      font-size: 1.2rem;
      color: var(--color-gold);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid var(--color-border);
    }
    
    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group.full-width {
      grid-column: span 2;
    }
    
    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--color-text-primary);
    }
    
    .form-group label .required {
      color: var(--color-gold);
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 14px 16px;
      font-size: 1rem;
      border: 1px solid var(--color-border);
      border-radius: 8px;
      background: var(--color-bg-primary);
      color: var(--color-text-primary);
      transition: border-color 0.3s ease;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--color-gold);
    }
    
    .form-group input::placeholder,
    .form-group textarea::placeholder {
      color: var(--color-text-muted);
    }
    
    .form-group select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23D4AF37' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 16px center;
      padding-right: 40px;
      cursor: pointer;
    }
    
    .form-group .hint {
      font-size: 0.85rem;
      color: var(--color-text-muted);
      margin-top: 6px;
    }
    
    .form-group .error {
      font-size: 0.85rem;
      color: var(--color-error);
      margin-top: 6px;
      display: none;
    }
    
    .form-group.has-error input,
    .form-group.has-error select,
    .form-group.has-error textarea {
      border-color: var(--color-error);
    }
    
    .form-group.has-error .error {
      display: block;
    }

    /* Apply Method Toggle */
    .apply-method {
      display: flex;
      gap: 16px;
      margin-bottom: 20px;
    }
    
    .apply-option {
      flex: 1;
      padding: 16px;
      background: var(--color-bg-primary);
      border: 1px solid var(--color-border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
    }
    
    .apply-option:hover {
      border-color: rgba(212, 175, 55, 0.3);
    }
    
    .apply-option.active {
      border-color: var(--color-gold);
      background: rgba(212, 175, 55, 0.1);
    }
    
    .apply-option input {
      display: none;
    }
    
    .apply-option .icon {
      font-size: 1.5rem;
      margin-bottom: 8px;
    }
    
    .apply-option .label {
      color: var(--color-text-primary);
      font-weight: 600;
    }
    
    .apply-option .desc {
      color: var(--color-text-muted);
      font-size: 0.85rem;
      margin-top: 4px;
    }
    
    .apply-fields {
      display: none;
    }
    
    .apply-fields.active {
      display: block;
    }

    /* Checkbox */
    .checkbox-group {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      padding: 16px;
      background: var(--color-bg-primary);
      border-radius: 8px;
      border: 1px solid var(--color-border);
    }
    
    .checkbox-group input[type="checkbox"] {
      width: 20px;
      height: 20px;
      margin-top: 2px;
      accent-color: var(--color-gold);
      cursor: pointer;
    }
    
    .checkbox-group label {
      color: var(--color-text-secondary);
      font-size: 0.95rem;
      cursor: pointer;
      line-height: 1.5;
    }
    
    .checkbox-group a {
      color: var(--color-gold);
    }

    /* Submit Button */
    .submit-btn {
      width: 100%;
      padding: 18px;
      background: var(--color-gold);
      color: var(--color-bg-primary);
      font-size: 1.1rem;
      font-weight: 700;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 24px;
    }
    
    .submit-btn:hover {
      background: var(--color-gold-hover);
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(212, 175, 55, 0.3);
    }
    
    .submit-btn:disabled {
      background: var(--color-text-muted);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    /* Success Message */
    .success-message {
      display: none;
      text-align: center;
      padding: 60px 40px;
    }
    
    .success-message.active {
      display: block;
    }
    
    .success-message .icon {
      font-size: 4rem;
      margin-bottom: 24px;
    }
    
    .success-message h2 {
      color: var(--color-gold);
      font-size: 1.8rem;
      margin-bottom: 16px;
    }
    
    .success-message p {
      color: var(--color-text-muted);
      font-size: 1.1rem;
      margin-bottom: 32px;
    }
    
    .success-message a {
      color: var(--color-gold);
      text-decoration: none;
    }
    
    .success-message a:hover {
      text-decoration: underline;
    }

    /* Alert */
    .form-alert {
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 24px;
      display: none;
    }
    
    .form-alert.active {
      display: block;
    }
    
    .form-alert.error {
      background: rgba(220, 53, 69, 0.1);
      border: 1px solid rgba(220, 53, 69, 0.3);
      color: var(--color-error);
    }

    /* Footer */
    .footer {
      background: var(--color-bg-primary);
      color: var(--color-text-muted);
      padding: 60px 40px 30px;
      border-top: 1px solid rgba(212, 175, 55, 0.2);
    }
    
    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 40px;
    }
    
    .footer h4 {
      color: var(--color-text-primary);
      margin: 0 0 16px 0;
    }
    
    .footer a {
      color: var(--color-text-muted);
      text-decoration: none;
      display: block;
      padding: 4px 0;
      transition: color 0.3s ease;
    }
    
    .footer a:hover {
      color: var(--color-gold);
    }
    
    .footer-bottom {
      max-width: 1200px;
      margin: 40px auto 0;
      padding-top: 24px;
      border-top: 1px solid var(--color-border);
      text-align: center;
    }

    /* Mobile */
    @media (max-width: 768px) {
      header {
        padding: 15px 20px;
      }
      
      nav ul {
        display: none;
      }
      
      .page-container {
        padding: 100px 20px 60px;
      }
      
      .form-card {
        padding: 24px;
      }
      
      .form-row {
        grid-template-columns: 1fr;
      }
      
      .form-group.full-width {
        grid-column: span 1;
      }
      
      .apply-method {
        flex-direction: column;
      }
    }

    /* Menu toggle */
    .menu-toggle {
      display: none;
      flex-direction: column;
      gap: 5px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 5px;
    }
    
    .menu-toggle span {
      width: 25px;
      height: 2px;
      background: var(--color-bg-white);
    }
    
    @media (max-width: 768px) {
      .menu-toggle {
        display: flex;
      }
    }
  </style>
  <link rel="stylesheet" href="/vergo-platform.css">
</head>
<body class="platform">
  <a href="#main-content" class="skip-link">Skip to main content</a>
  <header></header>

  <main id="main-content" class="page-container">
    <div class="page-header">
      <h1>Post a Job</h1>
      <p>Reach London's best hospitality professionals. Free to post, reviewed within 24 hours.</p>
    </div>
    
    <div class="form-card">
      <!-- Success Message -->
      <div class="success-message" id="success-message">
        <div class="icon">‚úì</div>
        <h2>Job Submitted!</h2>
        <p>We'll review your listing and publish it within 24 hours. You'll receive an email confirmation shortly.</p>
        <a href="jobs">‚Üê Back to Job Board</a>
      </div>
      
      <!-- Form -->
      <form id="post-job-form">
        <div class="form-alert error" id="form-alert"></div>
        
        <!-- Company Info -->
        <div class="form-section">
          <h2>Company Details</h2>
          
          <div class="form-row">
            <div class="form-group">
              <label>Company Name <span class="required">*</span></label>
              <input type="text" name="companyName" required placeholder="e.g. Premier Events Ltd">
              <div class="error">Please enter your company name</div>
            </div>
            
            <div class="form-group">
              <label>Contact Email <span class="required">*</span></label>
              <input type="email" name="posterEmail" required placeholder="hiring@yourcompany.com">
              <div class="error">Please enter a valid email</div>
            </div>
          </div>
        </div>
        
        <!-- Job Details -->
        <div class="form-section">
          <h2>Job Details</h2>
          
          <div class="form-group">
            <label>Job Title <span class="required">*</span></label>
            <input type="text" name="title" required placeholder="e.g. Bartender for Corporate Gala">
            <div class="error">Please enter a job title</div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Role Type <span class="required">*</span></label>
              <select name="roleId" required id="role-select">
                <option value="">Select role...</option>
              </select>
              <div class="error">Please select a role</div>
            </div>
            
            <div class="form-group">
              <label>Location <span class="required">*</span></label>
              <input type="text" name="location" required placeholder="e.g. Central London">
              <div class="error">Please enter a location</div>
            </div>
          </div>
          
          <div class="form-row">
            <div class="form-group">
              <label>Pay Rate (¬£/hr)</label>
              <input type="number" name="payRateMin" min="10" max="100" step="0.50" placeholder="e.g. 15.00">
              <div class="hint">Minimum rate you're offering</div>
            </div>
            
            <div class="form-group">
              <label>Up to (¬£/hr)</label>
              <input type="number" name="payRateMax" min="10" max="100" step="0.50" placeholder="e.g. 20.00">
              <div class="hint">Maximum rate (optional)</div>
            </div>
          </div>
          
          <div class="form-group">
            <label>Job Description <span class="required">*</span></label>
            <textarea name="description" required rows="5" placeholder="Describe the role, responsibilities, dress code, what to expect..."></textarea>
            <div class="hint">Minimum 20 characters</div>
            <div class="error">Please provide a description (min 20 characters)</div>
          </div>
        </div>
        
        <!-- Application Method -->
        <div class="form-section">
          <h2>How Should Candidates Apply?</h2>
          
          <div class="apply-method">
            <label class="apply-option active" id="opt-email">
              <input type="radio" name="applyMethod" value="email" checked>
              <div class="icon">‚úâÔ∏è</div>
              <div class="label">Email Applications</div>
              <div class="desc">Receive applications via email</div>
            </label>
            
            <label class="apply-option" id="opt-url">
              <input type="radio" name="applyMethod" value="url">
              <div class="icon">üîó</div>
              <div class="label">External Link</div>
              <div class="desc">Direct to your careers page</div>
            </label>
          </div>
          
          <div class="apply-fields active" id="fields-email">
            <div class="form-group">
              <label>Application Email</label>
              <input type="email" name="applyEmail" placeholder="Same as contact email if left blank">
            </div>
          </div>
          
          <div class="apply-fields" id="fields-url">
            <div class="form-group">
              <label>Application URL <span class="required">*</span></label>
              <input type="url" name="externalUrl" placeholder="https://yourcompany.com/careers/job-123">
              <div class="error">Please enter a valid URL</div>
            </div>
          </div>
        </div>
        
        <!-- Confirmation -->
        <div class="form-section">
          <div class="checkbox-group">
            <input type="checkbox" name="confirm" id="confirm" required>
            <label for="confirm">
              I confirm this is a legitimate job posting and agree to the <a href="terms" target="_blank">Terms of Service</a>. I understand the listing will be reviewed before publishing.
            </label>
          </div>
        </div>
        
        <!-- Honeypot -->
        <div style="display:none">
          <input type="text" name="website" tabindex="-1" autocomplete="off">
        </div>
        
        <button type="submit" class="submit-btn" id="submit-btn">
          Submit Job for Review
        </button>
      </form>
    </div>
  </main>

  <footer class="footer">
    <div class="footer-content">
      <div>
        <h4>VERGO Ltd</h4>
        <p>London's premium event staffing agency.</p>
      </div>
      <div>
        <h4>Services</h4>
        <a href="hire-staff">Hire Event Staff</a>
        <a href="pricing">Pricing</a>
      </div>
      <div>
        <h4>Company</h4>
        <a href="about">About Us</a>
        <a href="jobs">Job Board</a>
        <a href="contact">Contact</a>
      </div>
      <div>
        <h4>Legal</h4>
        <a href="privacy">Privacy Policy</a>
        <a href="terms">Terms of Service</a>
      </div>
    </div>
    <div class="footer-bottom">
      <p>&copy; 2024 VERGO Ltd. All rights reserved.</p>
    </div>
  </footer>

  <script>
    // Load roles
    async function loadRoles() {
      try {
        const res = await fetch('/api/v1/jobs/meta/roles');
        const payload = await res.json();
        const roles = payload.data ?? payload;
        
        const select = document.getElementById('role-select');
        
        if (roles.length === 0) {
          // Fallback defaults
          const defaults = ['Bartender', 'Waiter', 'Chef', 'Kitchen Porter', 'Catering Assistant', 'Front of House', 'Event Manager'];
          defaults.forEach(name => {
            const opt = document.createElement('option');
            opt.value = name.toLowerCase();
            opt.textContent = name;
            select.appendChild(opt);
          });
        } else {
          roles.forEach(role => {
            const opt = document.createElement('option');
            opt.value = role.id;
            opt.textContent = role.name;
            select.appendChild(opt);
          });
        }
      } catch (err) {
        console.error('Failed to load roles:', err);
      }
    }
    
    // Apply method toggle
    const optEmail = document.getElementById('opt-email');
    const optUrl = document.getElementById('opt-url');
    const fieldsEmail = document.getElementById('fields-email');
    const fieldsUrl = document.getElementById('fields-url');
    
    optEmail.addEventListener('click', () => {
      optEmail.classList.add('active');
      optUrl.classList.remove('active');
      fieldsEmail.classList.add('active');
      fieldsUrl.classList.remove('active');
    });
    
    optUrl.addEventListener('click', () => {
      optUrl.classList.add('active');
      optEmail.classList.remove('active');
      fieldsUrl.classList.add('active');
      fieldsEmail.classList.remove('active');
    });
    
    // Form submission
    const form = document.getElementById('post-job-form');
    const submitBtn = document.getElementById('submit-btn');
    const formAlert = document.getElementById('form-alert');
    const successMessage = document.getElementById('success-message');
    
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Reset errors
      document.querySelectorAll('.form-group').forEach(g => g.classList.remove('has-error'));
      formAlert.classList.remove('active');
      
      // Get form data
      const formData = new FormData(form);
      const data = {
        companyName: formData.get('companyName')?.trim(),
        posterEmail: formData.get('posterEmail')?.trim(),
        title: formData.get('title')?.trim(),
        roleId: formData.get('roleId'),
        location: formData.get('location')?.trim(),
        description: formData.get('description')?.trim(),
        payRateMin: formData.get('payRateMin') ? parseFloat(formData.get('payRateMin')) : undefined,
        payRateMax: formData.get('payRateMax') ? parseFloat(formData.get('payRateMax')) : undefined,
        payType: 'HOURLY',
        confirm: formData.get('confirm') === 'on',
        website: formData.get('website') // Honeypot
      };
      
      // Apply method
      const applyMethod = formData.get('applyMethod');
      if (applyMethod === 'email') {
        data.applyEmail = formData.get('applyEmail')?.trim() || data.posterEmail;
      } else {
        data.externalUrl = formData.get('externalUrl')?.trim();
      }
      
      // Validation
      let hasErrors = false;
      
      if (!data.companyName) {
        document.querySelector('[name="companyName"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (!data.posterEmail || !data.posterEmail.includes('@')) {
        document.querySelector('[name="posterEmail"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (!data.title) {
        document.querySelector('[name="title"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (!data.roleId) {
        document.querySelector('[name="roleId"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (!data.location) {
        document.querySelector('[name="location"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (!data.description || data.description.length < 20) {
        document.querySelector('[name="description"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (applyMethod === 'url' && !data.externalUrl) {
        document.querySelector('[name="externalUrl"]').closest('.form-group').classList.add('has-error');
        hasErrors = true;
      }
      
      if (!data.confirm) {
        formAlert.textContent = 'Please confirm the checkbox to submit.';
        formAlert.classList.add('active');
        hasErrors = true;
      }
      
      if (hasErrors) {
        window.scrollTo({ top: 0, behavior: 'smooth' });
        return;
      }
      
      // Submit
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';
      
      try {
        const res = await fetch('/api/v1/jobs/submit', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const payload = await res.json();
        const result = payload.data ?? payload;
        
        if (!res.ok) {
          throw new Error(result.error || result.details?.join(', ') || 'Failed to submit');
        }
        
        // Show success
        form.style.display = 'none';
        successMessage.classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
      } catch (err) {
        formAlert.textContent = err.message;
        formAlert.classList.add('active');
        window.scrollTo({ top: 0, behavior: 'smooth' });
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit Job for Review';
      }
    });
    
    // Init
    loadRoles();
  </script>
  <script src="/vergo-utils.js"></script>
  <script src="/vergo-nav.js"></script>
  <script src="/vergo-footer.js"></script>
  <script src="/vergo-analytics.js"></script>
<!-- Google Analytics (non-blocking) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-L4XRTDYMTZ"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-L4XRTDYMTZ');
</script>
</body>
</html>
